# プロジェクトルール

仕様は docs/spec.md を参照してください。
フォルダ構成は PROJECT_STRUCTURE.md を参照してください。

## 絶対に守ること

どこに出しても恥ずかしくないお手本となるコードを生成してください。

## コーディングルール

カバレッジは 100％を目指すこと。

- コードは ESLint で Lint をかけること。
- フォーマッタは Prettier を使用すること。
- コードの可読性を重視すること。
- SOLID 原則に従うこと。
- DRY 原則に従うこと。
- KISS 原則に従うこと。
- YAGNI 原則に従うこと。
- 依存関係の注入を意識すること
- テストは Jest を使用すること。
- テストはユニットテストと統合テストを実施すること。
- テストは CI/CD で実行すること。
- テストは GitHub Actions で実行すること。
- テストは PR 時に実行すること。
- Claude等のAIを使用してコードを生成する場合、生成結果を鵜呑みにせず、セキュリティ・可読性・効率性の観点からレビューを必ず行うこと。

## コードレビュー方針
- コメントは建設的かつ具体的に。
- 必要に応じてGitHub DiscussionsまたはIssueで設計・実装方針の議論を行う。

## エラーハンドリング
- 予期しうるエラーは明示的に捕捉・処理すること。
- ログ出力は状況を特定可能な情報（例：対象リソースID、発生箇所）を含める。
- 例外メッセージはユーザー・開発者の双方が理解しやすい文言とする。

- **設計思想**
  - モジュール化: 各リソースを独立したコンストラクトとして定義。
  - セキュリティ: 必要最小限の IAM ポリシーを付与。
  - 環境依存性の排除: 環境ごとの設定を `config` オブジェクトで管理。

### テスト

- ユニットテストは `test/` ディレクトリに配置。

- 実行コマンド:

  ```bash
  make test

- テストカバレッジは 100％ を目指す。

- タスクの終了時には make before_commit を実行してエラーが無いことを確認すること。
- テストの書き方
- 何をテストしているのかがひと目でわかるように、テストのタイトルや describe/it/test の名前を工夫する。describe や it の名前は、テストの内容を簡潔に日本語で説明するようにする。

### 例

```test.ts
describe("API Gateway の検証", () => {
  test("API Gateway が作成されていること", () => {
    template.resourceCountIs("AWS::ApiGateway::RestApi", 1);
  });

  test("API Gateway にタグが付与されていること", () => {
    template.hasResourceProperties("AWS::ApiGateway::RestApi", {
      Tags:[
        { Key: "Application", Value: "assetManager" },
        { Key: "Environment", Value: "develop" },
     ],
    });
  });
});
```

上記のように、「どのような仕様をテストしているのか」がテスト結果から伝わるようにする。
必要に応じてコメントで「このテストの仕様」を明記し、可読性を高める。

## Git 運用ルール
- ブランチ命名は `feature/xxx`, `fix/xxx`, `hotfix/xxx` など用途に応じて使い分ける。
- `main` または `develop` ブランチへの直接pushは禁止。
- PRはできるだけ小さく、1つの目的に集中させること。